<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!--
  Gregorio web site.
  Copyright (C) 2007-2015 The Gregorio project

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->
  <title>Gregorio project website</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="description" content="Free software for typesetting Gregorian chant" lang="en">
  <meta name="keywords" content="Gregorian chant, gregorio, gabc, gregoriotex" lang="en">
  <meta name="author" content="The Gregorio project">
  <link rel="shortcut icon" href="/illus/fav.ico">
  <link rel="icon" href="/illus/fav.ico">
  <link rel="stylesheet" href="/style.css" type="text/css" title="default">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script>
    var context = 'gregorio';
    var title = 'Gregorio project website'
  </script>
</head>

<body>
  <div id="ban">
    <img src="/illus/harpedroite.png" title="" class="hd" alt="" />
    <a id="haut" name="haut"></a>
    <div id="banniere">
    </div>
  </div>
  <div class="menu">
    <ul class="menuitem">
      <li><a href="/">Gregorio</a>
        <ul class="level2" id="menu-gregorio">
          <li><a href="/gregorio-history.html">About</a> </li>
          <li><a href="https://github.com/gregorio-project/gregorio/releases">Download</a> </li>
          <li><a href="/installation.html">Installation</a> </li>
          <li><a href="/tutorial/index.html">gabc Tutorial</a></li>
          <li><a href="/introduction.html">GregorioTeX Tutorial</a></li>
          <li><a href="/technical-aspects.html">For developers</a></li>
          <li><a href="legalissues.html">Legal issues</a></li>
        </ul>
      </li>
      <li><a href="/gregoriotex/index.html">GregorioTeX</a>
        <ul class="level2" id="menu-gregoriotex">
          <li><a href="/gregoriotex/tex.html">TeX?</a></li>
          <li><a href="/gregoriotex/details.html">Detailed description</a></li>
          <li><a href="/gregoriotex/features.html">Extra features</a></li>
          <li><a href="/gregoriotex/introduction.html">Tutorial</a></li>
        </ul>
      </li>
      <li><a href="/gabc/index.html">gabc</a>
        <ul class="level2" id="menu-gabc">
          <li><a href="/gabc/index.html">Basics</a></li>
          <li><a href="/gabc/details.html">Details</a></li>
          <li><a href="/tutorial/index.html">Tutorial</a></li>
        </ul>
      </li>
      <li><a href="/structure.html">Gregorian notation</a>
        <ul class="level2" id="menu-notation">
          <li><a href="/structure.html">Structure</a></li>
          <li><a href="/graphy.html">Alignment</a></li>
          <li><a href="/examples.html">Scores</a></li>
        </ul>
      </li>
      <li><a href="/contact.html">Contact</a>
      </li>
      <li><a href="/links.html">Links</a>
      </li>
    </ul>
  </div>
  <div class="flux">
    &nbsp;
    <!-- IE patch-->
    <div class="text">
      <!-- End of header -->
<!-- header -->
<script>
    context = 'gregoriotex';
    title = 'GregorioTeX';
</script>

<h1>Detailed information on GregorioTeX</h1>

<p>This page presents some detailed instructions on the use of GregorioTeX, starting with the most basic: best practices for creating an engraved (that is, typeset) score in GregorioTeX, then some simple options for modifying the score, and finally a precise description of the contents of a GregorioTeX file.</p>

<h2>Best practices for creating an engraved score</h2>

<p>In order to produce a perfect result and avoid errors in placement, you will need to specify some changes in line breaks by hand. The following is the most effective and simple method:</p>

<ul>
<li>produce a gabc file describing your score, without specifying any formatting</li>
<li>determine the ideal size of the score</li>
<li>define the style of the initial letter and the typeface for the characters of the text</li>
<li>finally, set line breaks in the gabc file</li>
</ul>

<p>When you specify line breaks in gabc, it is possible that a line may break in the middle of a word, but without adding a hyphen at the end of the line. The only way to correct this is to add a hyphen by hand to the last syllable before the line break, directly in the gabc file.</p>

<h2>Modifying the style of a score</h2>

<p>GregorioTeX is a relatively flexible style, in which you can modify many things.</p>

<h3>Changing the size of a score</h3>

<p>You can change the size of a GregorioTeX score simply, by calling the macro <code>\setgrefactor{}</code> with a whole number. For example, calling it with 17 (the default value), you will obtain a score whose notes, spaces, etc., will be the same as in the Solesmes Antiphonale (2005).</p>

<h3>Modifying the text style</h3>

<p>You can modify the style of the initial letter or the styles of the text by redefining the following macros:</p>
<ul>
<li><code>\gretextformat#1</code> for the style of the text of the scores</li>
<li><code>\greinitialformat#1</code> for the style of the large initial</li>
<li><code>\grebiginitialformat#1</code> for the style of a large initial two lines tall</li>
<li><code>\gretranslationformat#1</code> for the style of the translation</li>
<li><code>\grehighchoralsignstyle#1</code> for the style of the high choral signs</li>
<li><code>\grelowchoralsignstyle#1</code> for the style of the low choral signs</li>
<li><code>\greabovelinestextstyle#1</code> for the style of the text above the lines</li>
<li><code>\greitalic#1</code> for text in italics</li>
<li><code>\gresmallcaps#1</code> for text in small capitals</li>
<li><code>\grebold#1</code> for bold text</li>
<li><code>\grett#1</code> for monospaced (typewriter style) text</li>

</ul>

<h3>Making the initial letter two lines high</h3>

<p>To make the initial letter of a score as tall as two staff lines, call the macro <code>\setbiginitial</code> before <code>\includescore</code>. Note that you have to specifiy end of lines in order for it to work.</p>

<h3>Adding indications to the score</h3>

<p>It is often useful to add indications to gregorian chant scores, for example the mode, above the initial letter of the score, or an indication of the origin of the text above the score.</p>

<p>To add indications above the initial letter, you can use the macro <code>\gresetfirstlineaboveinitial{}{}</code>, which takes two arguments: the first is the text you wish to set there.  If you want the top of the text to be aligned with the top line of the staff, then use the same text as the second argument.</p>

<p>If you want to adjust the alignment by hand, you can change the second argument to a text with a height specification such as, for example, <code>\Large A</code> or <code>\tiny A</code>.  The height of that character string is used as a vertical offset.  If the second argument is, for example, 9 pt. in height, then the first argument will be displayed with the baseline of its text 9 pt. below the top line of the staff.   Therefore, a taller second argument makes the first argument display lower, and a less tall second argument makes the first argument display higher.</p>

<p>To add a note about source of the text, call the macro <code>\commentary{}</code> which takes a text argument.   It will be displayed, right-aligned, just above the score.  This macro (and <code>\gresetfirstlineaboveinitial</code> must be called immediately before the <code>\includescore</code> without an intervening blank line.</p>



<h3>Modifying the vertical spacing</h3>

<p>Gregorio adjusts vertical spacing automatically whenever there is an additional line, with the macro <code>\grenewlinewithspace{}{}</code>, described below.  Still, the vertical spacing may not be ideal for your purposes, so you can adjust spacing in several ways:</p>

<ul>
<li><code>\spaceabovelines</code> for the space above the staff</li>
<li><code>\spacelinestext</code> for the space between the baseline of the text and the bottom line of the staff</li>
<li><code>\spacebeneathtext</code> for the space below the text</li>
<li><code>\translationheight</code> for space dedicated to a translation of the text, if there is one</li>
</ul>

<p>To change other spaces, copy the file <code>gsp-default.tex</code>, rename it in <code>gsp-myspaces.tex</code>, change the values of the spaces and call <code>\GreLoadSpaceConf{myspaces}</code>.</p>

<p>It is also possible to change TeX algorithm for spacing. For instance try to put this in your code before any score inclusion:</p>

<div class="commandline">
<code>\tolerance=9999</code><br />
<code>\pretolerance=500</code>
</div>

<p>It should give a better result, but also more spacing and thus more lines.</p>

<h3>Other useful things</h3>

<p>A lot of useful things can be made with GregorioTeX. For example:</p>

<ul>
<li><code>\greremovelines</code> removes completely the staff lines</li>
<li><code>\greremoveclef</code> removes the keys</li>
<li><code>\gresetstafflinefactor#1</code> changes the thickness of the staff lines. 10 is the default value. You can only put integers here</li>
<li><code>\UseAlternatePunctumCavum</code> changes the shape of the punctum cavum</li>
<li><code>\GreDisableEOLShifts</code> slightly changes the beginning of line algorithm. <code>\GreEnableEOLShifts</code> restores the default spacing at the beginning of lines.</li>
<li><code>\greusemensuralstyle</code>, <code>\greusehufnagelstyle</code> and <code>\greusemedicaeastyle</code> change the style of some signs</li>
<li><code>\GreDontHidePCLines</code> unhides the staff lines behind the punctum cavum</li>
<li><code>\GreHideAltLines</code> hides the staff lines behind the alterations.</li>
</ul>

<h2>Understanding a GregorioTeX file</h2>

<p>In contrast to the competing TeX systems (OpusTeX and MusixTeX), GregorioTeX is not designed to be written by a human being but by the gregorio software. This makes it more difficult to understand, but it is necessary in order to obtain certain improvements in the output.</p>

<p>A GregorioTeX file is basically composed of 3 parts:</p>

<ul>
  <li>the first describes the large initial letter, the surrounding markings, and the clef, and gives information on the score</li>
  <li>the second is the part describing the notes and the syllables</li>
  <li>the last gives the final bar, which is treated in a special manner, and closes the score</li>
</ul>
 
<p>As you can confirm, each line ends with a percent sign: <code>%</code>. this symbol is the comment symbol in TeX: everything after this character is not read by TeX, including end-of-line characters.  If TeX were to read the EOLs, it would insert unwanted spaces and change the final result. By placing a <code>%</code> at the end of each line, we can be sure that that does not happen.  Remember this point if you modify the file.</p>

<h3>First part</h3>

<p class="nofirst"><code>\begingregorioscore</code> creates the TeX environment for Gregorio scores and initializes variables.</p>

<p class="nofirst"><code>\greinitial{}</code> takes as its argument the letter (or letters) of the initial.  </p>

<p class="nofirst"><code>\grebeginscore</code> (which absolutely must be placed after <code>\greinitial{}</code>) produces the first line of the score and gives TeX the instruction to begin each line of the score with staff lines.</p>

<p class="nofirst"><code>\grebiginitial</code> is a macro to be used with the large capital is two lines in height.</p>

<p class="nofirst"><code>\gresetinitialclef{}{}</code> takes as its first argument the type of clef (c for the do-clef, f for the fa-clef), and as its second argument the line on which it is to be placed.  This produces the clef of the first line and gives an instruction to TeX to begin each new line with this clef.</p>

<h3>Second part</h3>

<h4>First level</h4>

<p>The second part has several levels.  The principal macro of the second part is the macro <code>\gresyllable</code>, which is the most complex. This macro takes 9 arguments, which we shall present in detail.  The macro describes a syllable very comprehensively: the text, the position within the word, etc.</p>

<p>You have very likely noticed that in the scores produced by GregorioTeX, the alignment of the note is not made above the first letter of a syllable, but above the first vowel.  Thus it is necessary to distinguish three zones within a syllable:</p>

<ul>
<li>the letters which precede the alignment letters</li>
<li>the letter (or letters) on which alignment is made with the notes (in most cases the first vowel, cf. the <a href="/gregorio/graphy">page on alignment</a>)</li>
<li>the letters which follow the alignment letters</li>
</ul>

<p>The first three arguments of the macro <code>\gresyllable</code> correspond to these three zones, in order.</p>

<p>The fourth argument is a boolean: it is one (1) if the syllable is the last one in the word, otherwise zero (0).</p>

<p>Arguments 5 and 6 are redundant but necessary arguments: the fifth consists of the letters preceding the alignment letters of the following syllable, and the sixth consists of the alignment letters of the following syllable. </p>

<p>Argument 7 is the alignment type of the following syllable (depending solely on the notes). This argument has many possible values, and there is no real reason to modify it. Its complete description can be found in the TeX code of GregorioTeX.</p>

<p>Argument 8 is the most often unused argument; it relates to macros to be called before the note macros, for example, the translation of the syllable.</p>

<p>Argument 9 is the largest, corresponding to the various notes in the score.  As you will be able to see, the argument is quite often specified on several lines; it corresponds to the second level of the description of a score in GregorioTeX.</p>

<p>Another important macro of the first level is the macro <code>\grebarsyllable</code> which has the same arguments as <code>syllable</code>, but is used to describe the syllables containing only a bar and no notes.</p>

<p>The last important macro of this level is the macro <code>\grenewline</code>, which forces TeX to go to a new line and improves the spacing at the beginning of the following line. Another version, <code>\grenewlinewithspace{}{}{}</code>, goes to a new line, but adds spacing above and below.   The first argument corresponds to the height of the highest note that exceeds the upper range of the staff (1 for a k, 2 for an l, 3 for an m).  The second argument is the equivalent for the lower notes. The third argument is 1 if there is a translation, otherwise 0.</p>

<p class="nofirst">These two last macros have some equivalents to go to the next line without justifying the line: <code>\grenewparline</code> and <code>\grenewparlinewithspace{}{}{}</code>.</p>

<h4>Second level</h4>

<p>The second level seldom needs to be modified, inasmuch as it is quite a bit easier, in modifying a note or a group of notes, to modify the gabc file and to recompile it.  In the meantime it may perhaps be useful to at least understand it.</p>
 
<p>The principal macro of the second level is the macro <code>\greglyph</code>. This macro describes a gregorian glyph (a simple note or any grouping of notes) and takes 6 arguments.</p>

<p>The first argument is the number of the glyph.  In fact Gregorio possesses a simple numbering system for the gregorian glyphs, going from 1 to 65536, which allows any glyph to be represented in two eight-bit bytes. Glyphs with different ambitus do not have the same numbers, but the number does not describe its position on the staff. This numbering system is too complex to be described here, and besides you normally will never have to modify one of these numbers (again, recourse to the gabc file is a good solution). Meanwhile, the principle of the numbering systems is described in the GregorioTeX source files.</p>

<p>The second argument is the position on the staff. This is the same thing as the position in gabc.   The third argument is the position on the staff of the following note.  The third argument is the position on the staff of the following note. This serves to position the custos correctly at the end of the staff. The fourth argument is the type of note alignment. The fourth argument is the alignment type of the note. This is a slightly complex argument which is described in the source code for GregorioTeX.</p>

<p>The fifth argument are macros that must be expanded before the glyph sign, typically additional staff lines that must be "beneath" the glyph when they are in a different color. The sixth argument is just executed at the end of the macro.</p>

<p>The other macros of the second level are very obvious; they are principally macros describing the bars and various signs.</p>

<p>The macro <code>\greadjustthirdline</code> is included just after the first line break; it serves in case of a initial two lines tall, to reduce the left margin of the third and following lines. </p>

<h3>Third part</h3>

<p>The macro <code>\gredivisiofinalis{}</code> lets us describe the final division of a score.  It takes an argument because there are indeed two possibilities for this bar:</p>

<ul>
<li>It may be within the last line, in which case the argument is zero (0).</li>
<li>It may also be at the end of the last line, and in that case if the argument is set to 1, the last bar will indeed be aligned with the right end of the line, which will make the final result prettier.</li>
</ul>
 
<p>This argument is 0 by default; it is necessary to pass a 1 manually if you want it to be set.</p>

<p class="nofirst"><code>\endgregorioscore</code> ends a score, changing the paragraph and cancelling the instructions at the beginning and end of the line (for lines, clefs, and custodes.)</p>

<!-- footer -->
    </div>
    <div class="bottom">
    </div>
    <script>
      document.title = title;
      $.each(['gregorio', 'gregoriotex', 'gabc', 'notation'], function(i, menu) {
        if (context != menu) {
          $('#menu-'+menu).hide();
        }
      });
    </script>
  </body>
</html>
