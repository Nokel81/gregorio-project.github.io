<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!--
  Gregorio web site.
  Copyright (C) 2007-2015 The Gregorio project

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->
  <title>Gregorio project website</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="description" content="Free software for typesetting Gregorian chant" lang="en">
  <meta name="keywords" content="Gregorian chant, gregorio, gabc, gregoriotex" lang="en">
  <meta name="author" content="The Gregorio project">
  <link rel="shortcut icon" href="/illus/fav.ico">
  <link rel="icon" href="/illus/fav.ico">
  <link rel="stylesheet" href="/style.css" type="text/css" title="default">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script>
    var context = 'gregorio';
    var title = 'Gregorio project website'
  </script>
</head>

<body>
  <div id="ban">
    <img src="/illus/harpedroite.png" title="" class="hd" alt="" />
    <a id="haut" name="haut"></a>
    <div id="banniere">
    </div>
  </div>
  <div class="menu">
    <ul class="menuitem">
      <li><a href="/">Gregorio</a>
        <ul class="level2" id="menu-gregorio">
          <li><a href="/gregorio-history.html">About</a> </li>
          <li><a href="https://github.com/gregorio-project/gregorio/releases">Download</a> </li>
          <li><a href="/installation.html">Installation</a> </li>
          <li><a href="/tutorial/index.html">gabc Tutorial</a></li>
          <li><a href="/introduction.html">GregorioTeX Tutorial</a></li>
          <li><a href="/technical-aspects.html">For developers</a></li>
          <li><a href="legalissues.html">Legal issues</a></li>
        </ul>
      </li>
      <li><a href="/gregoriotex/index.html">GregorioTeX</a>
        <ul class="level2" id="menu-gregoriotex">
          <li><a href="/gregoriotex/tex.html">TeX?</a></li>
          <li><a href="/gregoriotex/details.html">Detailed description</a></li>
          <li><a href="/gregoriotex/features.html">Extra features</a></li>
          <li><a href="/gregoriotex/introduction.html">Tutorial</a></li>
        </ul>
      </li>
      <li><a href="/gabc/index.html">gabc</a>
        <ul class="level2" id="menu-gabc">
          <li><a href="/gabc/index.html">Basics</a></li>
          <li><a href="/gabc/details.html">Details</a></li>
          <li><a href="/tutorial/index.html">Tutorial</a></li>
        </ul>
      </li>
      <li><a href="/structure.html">Gregorian notation</a>
        <ul class="level2" id="menu-notation">
          <li><a href="/structure.html">Structure</a></li>
          <li><a href="/graphy.html">Alignment</a></li>
          <li><a href="/examples.html">Scores</a></li>
        </ul>
      </li>
      <li><a href="/contact.html">Contact</a>
      </li>
      <li><a href="/links.html">Links</a>
      </li>
    </ul>
  </div>
  <div class="flux">
    &nbsp;
    <!-- IE patch-->
    <div class="text">
      <!-- End of header -->
<!-- header -->
<script>
    context = 'gregorio';
    title = 'Using Gregorio in TeXShop';
</script>

<h1>Using Gregorio in TeXShop</h1>

<p>This page describes how to configure gregorio for use with TeXShop.  You will have to repeat this process for each user who uses TeXShop.</p>

<h3>Configure TeXShop</h3>

<p>Open the folder <code>~/Library/TeXShop/Engines</code> in Finder.  Copy the LuaLaTeX engine from the <code>Inactive/luaTeX</code> folder, and modify it by opening it with text editor (such as Textedit) and adding "--shell-escape" right after "lualatex".  This enables GregorioTeX to automatically compile your gabc scores as needed when LuaLaTeX compiles your document.</p>

<p>Finally open a Terminal window (it's in <code>Applications/Utilities</code>) and enter the following command:</p>

<div class="commandline">
<code>defaults write TeXShop OtherTeXExtensions -array-add "gabc"</code>
</div>

<p>This makes it so that TeXShop will recognize gabc files as ones it can work with.</p>


<h2 id="working">Working with TeXShop</h2>

<p>Overall, producing a score involves these steps:</p>

<ul>
<li>writing a gabc text file that describes the score.</li>
<li>producing GregorioTeX code based on the gabc file</li>
<li>compiling the GregorioTeX code thus produced, with LaTeX</li>
</ul>


<h3 id="gabc">Creating a gabc file</h3>

<p>For a first example, you can inspire from the score <code>PopulusSion.gabc</code> in the <code>examples/</code> directory of gregorio or <a href="http://svn.gna.org/svn/gregorio/trunk/examples/main-lualatex.tex">here</a>.  Save your file in a directory that will be our working directory. You need to save it with the extension ".gabc". You'll need to choose "Plain Text" or "UTF8 Plain Text" (use the latter if you used unicode characters) and enter the extension manually.</p>

<p>Then you need to type the description of the score in gabc. For more details, refer to the <a href="/gabc/index.html">gabc page</a>. For the rest of the introduction, let's suppose you keep this score as it is and that you save it as <code>example.gabc</code>.</p>

<h3>Compiling the main TeX file</h3>

<p>The last step is to compile the TeX file to get a PDF file.  We'll use LuaLaTeX through TeXworks for this.</p>

<p>Here are some explanations on this subtle part of the process: the TeX file produced by gregorio represents only the score, but it does not constitute an entire document. To typeset the score correctly, we need a main LaTeX file that will call our TeX file and set some typesetting rules (margins, title, style, fonts, etc.).</p>

<p>For this you will certainly need some notions of LaTeX. But for a first try, you can use the following barebones file:

<div class="commandline">
<code>\documentclass[11pt]{article}<br />
<br />
\usepackage{fontspec}<br />
<br />
\usepackage{gregoriotex}<br />
<br />
\begin{document}<br />
<br />
\includescore{example}<br />
<br />
\end{document}</code>
</div>

Copy the above into a new file and save it as <code>test.tex</code> in the same directory as <code>example.gabc</code>

<p>The goal now is to compile this file to get the final PDF.  To do that, and only that, you would use the LuaLaTeX engine that I mentioned above.  If you want to go that route, then select LuaLaTeX from the drop down list in the upper left or place the following line at the begining of the file:</p> 

<div class="commandline">
<code>% !TEX TS-program = LuaLaTeX</code>
</div>

<p>Then click on the "Typeset" button (or use the keyboard short cut).</p>

<p>If you correctly followed the instructions of this page, a PDF file will show up in the right part of your screen!  You're now ready to start playing with <a href="/gregorio/gregoriotex/details">the various commands available to tweak the appearence of the score.</a></p>


<h3 id="automation">Automated the typesetting process.</h3>

<p>In order to be able to compile your scores directly in TeXShop, add the following lines at the top of your gabc files:</p>

<div class="commandline">
<code>% !TEX root = test.tex</code><br />
<code>% !TEX TS-program = LuaLaTeX</code>
</div>

<p>The first line tells TeXShop that this file is part of a larger project whose main (or root) file is <code>test.tex</code>.  Now whenever you go to typeset <code>example.gabc</code> TeXShop wil typeset <code>test.tex</code> instead.  The second line is not really necessary in TeXShop, but you should probably have it there anyway to make it easier to share your source files with people using TeXworks (where it is required).</p>

<p><b>Note:</b> If your project combines LilyPond scores with Gregorio ones, then you need the following lines at the begining of all project files (in addition to the root designation in non-root files):</p>

<div class="commandline">
<code>% !TEX TS-program = LilyPond-Book</code><br />
<code>% !LILYPOND tex = lualatex --shell-escape</code>
</div>

<p>The first line tells TeXShop which engine to use, the second tells LilyPond-Book (which is called by greg-lily-book) to use lualatex instaed of pdflatex.  You'll also should probably name the project file <code>test.lytex</code> in order to avoid some potential name issues (see the documentation for LilyPond-Book for more details).</p>

<!-- footer -->
    </div>
    <div class="bottom">
    </div>
    <script>
      document.title = title;
      $.each(['gregorio', 'gregoriotex', 'gabc', 'notation'], function(i, menu) {
        if (context != menu) {
          $('#menu-'+menu).hide();
        }
      });
    </script>
  </body>
</html>
