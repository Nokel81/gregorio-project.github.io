<!--#set var="context" value="default" --><!--#set var="title" value="Introduction to Gregorio with TeXworks" --><!--#include virtual="/gregorio/header.en.html" -->

<h1><!--#echo var="title" --></h1>

<p>This page introduces the workflow of gregorio with TeXworks.</p>

<p>Overall, producing a score involves these steps:</p>

<ul>
<li>writing a gabc text file that describes the score</li>
<li>producing GregorioTeX code based on the gabc file</li>
<li>compiling the GregorioTeX code thus produced, with LaTeX</li>
</ul>

If you're using greg-book, most of the last two steps are automated, but we'll still go over how to do them individually just in case.

<h3 id="gabc">Creating a gabc file</h3>

<p>For a first example, you can inspire from the score <code>PopulusSion.gabc</code> in the <code>examples/</code> directory of gregorio or <a href="http://svn.gna.org/svn/gregorio/trunk/examples/main-lualatex.tex">here</a>. Under Windows, you simply need to create a new file from a template and to choose "Gregorio score". Save then your file in a directory that will be our working directory. You need to save it with the extension ".gabc". Under Windows, this extension appears automatically, otherwise you need to choose "All files".</p>

<p>Then you need to type the description of the score in gabc. For more details, refer to the <a href="/gregorio/gabc/">gabc page</a>. For the rest of the introduction, let's suppose you keep this score as it is and that you save it as <code>example.gabc</code>.</p>

<h3>Compilation of the gabc file into TeX</h3>

<p>Once you have saved your gabc file, let's produce the corresponding GregorioTeX code. This is made thanks to the gregorio software, through TeXworks.</p>

<p>If not already done, select "gregorio" in the top left menu of TeXworks like this:</p>

<div class="legende">
<img src="/gregorio/illus/select-gregorio-en.png" title="TeXworks typesetting engine menu" alt="" />
</div>

<p>You can also automate the selection (especially useful when reopening the file).  To do this place the following line at the begining of your gabc file:</p>

<div class="commandline">
<code>% !TEX TS-program = gregorio</code>
</div>


<p>Then click on the "Typeset" button.

<p>This will produce the file <code>example.gtex</code>, that contains the GregorioTeX code of our score.</p>

<p><i>Note for advanced users:</i> By default the gregorio engine produces files with the extension gtex instead of tex like the regular commandline (it uses the "-o" option to specify the output file name and extension).  This is a deliberate saftey mechanism that has to do with how TeXworks chooses its compilation engine when typesetting a multi-file project.  By doing it this way I greatly reduce the chance of accidently overwriting the project root file.</p>

<h3>Compiling the main TeX file</h3>

<p>The last step is to compile the TeX file to get a PDF file. We'll use LuaLaTeX through TeXworks for this.</p>

<p>Here are some explanations on this subtle part of the process: the TeX file produced by gregorio represents only the score, but it does not constitute an entire document. To typeset the score correctly, we need a main LaTeX file that will call our TeX file and set some typesetting rules (margins, title, style, fonts, etc.).</p>

<p>For this you will certainly need some notions of LaTeX. But for a first try, you can use the following barebones file:

<div class="commandline">
<code>\documentclass[11pt]{article}<br />
<br />
\usepackage{gregoriotex}<br />
<br />
\begin{document}<br />
<br />
\includescore{example.gtex}<br />
<br />
\end{document}</code>
</div>

Copy the above into a new file and save it as <code>test.tex</code> in the same directory as <code>example.gabc</code>

<p>The goal now is to compile this file to get the final PDF.  To do that, and only that, you would use the LuaLaTeX engine that I mentioned above.  If you want to go that route, then select LuaLaTeX from the drop down list in the upper left or place the following line at the begining of the file:</p> 

<div class="commandline">
<code>% !TEX TS-program = LuaLaTeX</code>
</div>

<p>Then click on the "Typeset" button (or use the keyboard short cut).</p>

<p>If you correctly followed the instructions of this page, a PDF file will show up in the right part of your screen!  You're now ready to start playing with <a href="/gregorio/gregoriotex/details">the various commands available to tweak the appearence of the score.</a></p>

<h3 id="automation">Automating the typesetting process.</h3>

<p>While the above step-by-step process works, it leaves you to manually typeset each gabc file when you change it and then typeset the main project file in order to see the changes.  Especially in large projects this can get cumbersome.  The greg-book (and greg-lily-book) engine automates the typesetting process for you, enabling you to speed up your work flow.</p>

<p>To use these engines, start by opening <code>example.gabc</code> back up.  Then place the following lines at the begining of your gabc file (replacing what I told you to put there earlier):</p>

<div class="commandline">
<code>% !TEX root = test.tex</code><br />
<code>% !TEX TS-program = greg-book</code>
</div>

<p>The first line tells TeXworks that this file is part of a larger project whose main (or root) file is <code>test.tex</code>.  Now whenever you go to typeset <code>example.gabc</code> TeXworks wil typeset <code>test.tex</code> instead.  The second line tells TeXworks which engine should be the defualt selection in the drop down list.  It is essential that this match the desired engine for the root project file, not the file currently being editted.  This is because TeXworks does not look for the preferred engine of the root file, but simply typesets it using the currently selected engine.</p>

<p>Now open <code>test.tex</code> and place the following line at the begining of the file (replacing what I told you to put there earlier):</p>

<div class="commandline">
<code>% !TEX TS-program = greg-book</code>
</div>

<p>This line tells TeXworks to pick greg-book by default from the available engines to typeset this file.  This engine will automatically check for included scores, check to see if they have changed, run gregorio on those that have, and then typeset the project with LuaLaTeX.</p>

<p>With both files setup like this, a typesetting command issued from either one will cause TeXworks to take all necessary steps to update your project and display the resulting pdf.  It's not much of a time saver here, but if you start creating projects with half-a-dozen or more scores in them, you'll be glad you have this setup.</p>

<p><b>Note:</b> If your project combines LilyPond scores with Gregorio ones, then you need the following lines at the begining of the all project files (in addition to the root designation for the non-root files):</p>

<div class="commandline">
<code>% !TEX TS-program = greg-lily-book</code><br />
<code>% !LILYPOND tex = lualatex --shell-escape</code>
</div>

<p>The first line tells TeXworks to use greg-lily-book, the second tells LilyPond-Book (which is called by greg-lily-book) to use lualatex instaed of pdflatex.  You'll also should probably name the project file <code>test.lytex</code> in order to avoid some potential name issues (see the documentation for LilyPond-Book for more details).  Along similar lines it is absolutely essential in projects using greg-lily-book that you provide an explicit extension for all include scores and that it not be "tex" (I suggest "gtex").  In projects using greg-book you can bend this rule quite a bit.</p>

<!--#include virtual="/gregorio/footer.en.html" -->
